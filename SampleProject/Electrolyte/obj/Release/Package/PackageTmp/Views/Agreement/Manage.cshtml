@model Electrolyte.Models.DashboardViewModel

@{
    ViewBag.Title = ViewBag.agreement.title;
}

<h2 class="agreementH2">@ViewBag.agreement.title</h2>

<div class="agreementDetailsSection">
    <div class="agreementDetails">
        <div id="agreementDescription">
            <span>Description:</span> @ViewBag.agreement.description
        </div>

        <div class="agreementDates">
            <span>Date Created:</span> @ViewBag.agreement.createddate.ToString("MM/dd/yyyy")
        </div>
    </div>
    <div class="agreementButtons">
        <img src="/Content/images/btnEditContract.png" onclick="com.CreateAgreement.edit(@ViewBag.agreement.id);" />
        <img src="/Content/images/btnDocumentManagement.png" />
        <img src="/Content/images/btnManageTasks.png" onclick="$('#agreementSection').get(0).scrollIntoView();" />
    </div>
    <div class="clearfix"></div>
</div>
<div class="clearfix"></div>

<h3 class="agreementH3">People Involved</h3>

<div class="agreementContactSection">
    <div class="agreementSectionContact">
        @foreach (var contact in ViewBag.agreement.Contacts)
        {
            <div class="agreementContactItem">
                <div class="agreementContactNickname">@(contact.nickname == "" ? "N/A" : contact.nickname )</div>
                <div class="agreementContactInfo">@contact.phone</div>
                <div class="agreementContactInfo">@contact.email</div>
                <div class="agreementContactInfo">@contact.street @contact.city, @contact.state @contact.zip</div>
            </div>
        }
    </div>

    <div class="agreementDatepicker">
        <div id="agreementCalendar"></div>
    </div>

    <div class="clearfix"></div>
</div>


<div class="agreementFilesSection">
    <h3 class="h3bold">Document Management</h3>

    <div class="agreementFileList">
        @if (ViewBag.agreement.Files.Count > 0) {
            foreach (var file in ViewBag.agreement.Files)
            {
                <div class="agreementFileItem">
                    @file.filename
                    <div class="agreementFileView" data-id="@file.id" onclick="com.CreateAgreement.viewFile($(this).data('id'), @ViewBag.agreement.id);">
                        DOWNLOAD
                    </div>
                </div>
            }
        }
        else
        {
            <text>
            <div class="agreementFileItem">No documents found.</div>
            </text>
        }
    </div>
</div>


<div class="agreementTasksSection" id="agreementSection">
    <h3 class="h3bold">Manage Tasks</h3>
    <div class="addTasks" onclick="com.CreateAgreement.openTasks(@ViewBag.agreement.id);">+ Create a New Task</div>

    <div class="agreementTasksList" id="agreementTaskList">
        @if (ViewBag.agreement.Tasks.Count > 0) {
            foreach (var task in ViewBag.agreement.Tasks)
            {
                <div class="agreementTaskItem">
                    <div class="blackBullet"></div>
                    <div class="taskSummary">
                        <div class="agreementTaskTitle">@task.title</div>
                        <div class="agreementTaskDescription">- @task.description</div>
                        <div class="agreementTaskDate">@task.datetime.ToString("MMMM d, yyyy h:mm tt")</div>
                    </div>
                    <div class="taskDelete" data-id="@task.id" onclick="com.CreateAgreement.deleteTask(this, $(this).data('id'), @ViewBag.agreement.id);"></div>
                    <div class="clearfix"></div>
                </div>
            }
        }
        else
        {
            <div>No tasks found.</div>
        }
        <div class="clearfix"></div>
    </div>
</div>

<script>
    com.CreateAgreement.taskDiv = $("#agreementTaskList");
    com.CreateAgreement.datepicker($("#agreementCalendar"));
</script>
